class l{#t;constructor(t){this.#t=structuredClone(t)}get(){return structuredClone(this.#t)}}class u{#t;#e;constructor(){this.#t=[],this.#e=-1}add(t){this.#e<this.#t.length-1&&(this.#t=this.#t.slice(0,this.#e+1)),this.#t.push(t),this.#e++}undo(){return this.#e>0?(this.#e--,this.#t[this.#e]):null}redo(){return this.#e<this.#t.length-1?(this.#e++,this.#t[this.#e]):null}changeCurrentMemento(t){return t>=0&&t<=this.#t.length-1?(this.#e=t,this.#t[t]):null}currentMemento(){return this.#e===-1?null:this.#t[this.#e].get()}getForIndex(t){return t>=0&&t<=this.#t.length-1?this.#t[t]:null}getHistory(){return this.#t.map(t=>new l(t.get()))}}const c=e=>e.replace(/\+\-/g,"-").replace(/\-\+/g,"-").replace(/--/g,"+").replace(/\+\+/g,"+").replace(/\(\+/g,"(").replace(/(\d+)%/g,"($1/100)").replace(/\)\(/g,")*(").replace(/(\d)(\()/g,"$1*(").replace(/(\))(\d)/g,")*$2"),h=e=>{const t=c(e),n=['"',";","`","<",">"];return/[a-zA-Z]/.test(t)||n.some(i=>t.includes(i))?{ok:!1,error:new Error("invalid format")}:{ok:!0,data:t}},p=e=>{const t=h(e);return t.ok?{ok:!0,data:t.data}:t};function d(e){try{const t=new Function(`return ${e}`)();if(isNaN(t))throw new Error("Is not a number");return{ok:!0,data:t}}catch(t){return{ok:!1,error:t}}}const g="_display__result_139jk_1",_={display__result:g,"result-left-gradient-line":"_result-left-gradient-line_139jk_16","result-right-gradient-line":"_result-right-gradient-line_139jk_20"},f="_display__operation_19qw7_1",m={display__operation:f,"operation-left-gradient-line":"_operation-left-gradient-line_19qw7_24","operation-right-gradient-line":"_operation-right-gradient-line_19qw7_28"},o=e=>document.querySelector(e),r={get operation(){return o(`.${m.display__operation}`)},get result(){return o(`.${_.display__result}`)},get hasOperation(){return!!this.operation.value.trim()},get hasResult(){return!!this.result.value.trim()},setOperation(e){r.operation.value=e},setResult(e){r.result.value=e},clear(){this.setOperation(""),this.setResult("")}},a=new u;class y{#t;constructor(){this.#t=""}get(){return this.#t}set(t){this.#t=t}del(){this.set(this.get().slice(0,-1)),r.setOperation(this.get()),r.operation.scrollLeft=r.operation.scrollWidth}push(t){this.set(this.get()+t),r.setOperation(this.get()),r.operation.scrollLeft=r.operation.scrollWidth}clear(){this.set(""),r.clear()}eval(){const t=a.currentMemento(),n=this.get()===t?.operation;if(!r.hasOperation){r.clear();return}if(n){r.hasResult||r.setResult(t?.result);return}try{const s=p(this.get());if(!s.ok)throw s.error;const i=d(s.data);if(!i.ok)throw i.error;a.add(new l({operation:this.get(),result:i.data})),r.setResult(i.data),r.result.scrollLeft=0}catch(s){console.error("Message:",s.message),console.error("Stack:",s.stack),r.setResult("Math error")}}}const k=new y;export{a as H,m as a,_ as s,k as u};
